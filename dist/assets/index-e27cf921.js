(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))d(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const b of t.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&d(b)}).observe(document,{childList:!0,subtree:!0});function i(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function d(e){if(e.ep)return;e.ep=!0;const t=i(e);fetch(e.href,t)}})();const L="/myst-cam/red.png",O="/myst-cam/blue.png",m=512,g=m/(4/3);let r=null,u=null,n=null,s=null,f="red",h="red";r=document.getElementById("webcam");u=document.querySelector("canvas");n=document.getElementById("redstatic");s=document.getElementById("bluestatic");r.setAttribute("width",m);r.setAttribute("height",g);const o=u.getContext("2d");u.width=m*2;u.height=g*2;n.setAttribute("width",m);n.setAttribute("height",g);s.setAttribute("width",m);s.setAttribute("height",g);navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(a=>{r.srcObject=a,r.play}).catch(a=>{console.error("Could not grab webcam")});n.play();s.play();const y=new Image(500,500);y.src=L;const v="#cd616a",A=new Image(500,500);A.src=O;const T="#6161cd";function S(){h=="red"?o.drawImage(n,592,200,n.width/1.74,n.height/1.74):o.drawImage(s,592,200,s.width/1.74,s.height/1.74)}function R(){h=="red"?(h="blue",o.fillStyle=T,f=A,s.play(),n.pause()):(h="red",o.fillStyle=v,f=y,n.play(),s.pause())}const I=document.getElementById("swapcolors");I.addEventListener("click",()=>{R()});const w=document.getElementById("recordvideo"),B=document.getElementById("download"),C={};function M(a,c){const i=new Blob(c,{type:"video/webm"});B.innerHTML=`
    <a href="#" id="downloadwebm">DOWNLOAD .WEBM</a>
    `,I.disabled=!1,w.disabled=!1;const d=document.getElementById("downloadwebm");let e=URL.createObjectURL(i);d.href=e,d.download="pages.webm"}w.addEventListener("click",()=>{let a=[];const c=u.captureStream(30),i=new MediaRecorder(c,C);i.ondataavailable=d=>{a.push(d.data)},i.onstop=d=>{M(i,a)},i.start(),B.innerHTML=`
    RECORDING...
    `,I.disabled=!0,w.disabled=!0,setTimeout(()=>{i.stop()},3e3)});o.fillStyle=v;f=y;let l=.6,p=!1;function D(){p||(p=!0,setTimeout(()=>{l-=.1},1e3),setTimeout(()=>{l-=.1},2e3),setTimeout(()=>{l-=.1},3e3),setTimeout(()=>{l-=.1},4e3),setTimeout(()=>{l-=.1},5e3),setTimeout(()=>{l+=.2},6e3),setTimeout(()=>{l+=.2},7e3),setTimeout(()=>{l=.6,p=!1},8e3))}function E(){requestAnimationFrame(E),S(),D(),o.globalAlpha=l,o.drawImage(r,592,200,r.width/1.74,r.height/1.74),o.globalAlpha=.5,o.fillRect(592,190,r.width/1.74,r.height/1.5),o.globalAlpha=1,o.drawImage(f,0,0,u.width,u.height)}E();
