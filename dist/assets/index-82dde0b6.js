(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))d(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const w of t.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&d(w)}).observe(document,{childList:!0,subtree:!0});function i(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function d(e){if(e.ep)return;e.ep=!0;const t=i(e);fetch(e.href,t)}})();const T="/myst-cam/red.png",S="/myst-cam/blue.png";let u=512,h=592,f=200;window.screen.width<800&&(u=u/2,h=h/2,f=f/2);const p=u/(4/3);let r=null,m=null,n=null,s=null,b="red",g="red";r=document.getElementById("webcam");m=document.querySelector("canvas");n=document.getElementById("redstatic");s=document.getElementById("bluestatic");r.setAttribute("width",u);r.setAttribute("height",p);const o=m.getContext("2d");m.width=u*2;m.height=p*2;n.setAttribute("width",u);n.setAttribute("height",p);s.setAttribute("width",u);s.setAttribute("height",p);navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(a=>{r.srcObject=a,r.play}).catch(a=>{console.error("Could not grab webcam")});n.play();s.play();const v=new Image(500,500);v.src=T;const B="#cd616a",E=new Image(500,500);E.src=S;const R="#6161cd";function C(){g=="red"?o.drawImage(n,h,f,n.width/1.74,n.height/1.74):o.drawImage(s,h,f,s.width/1.74,s.height/1.74)}function M(){g=="red"?(g="blue",o.fillStyle=R,b=E,s.play(),n.pause()):(g="red",o.fillStyle=B,b=v,n.play(),s.pause())}const A=document.getElementById("swapcolors");A.addEventListener("click",()=>{M()});const I=document.getElementById("recordvideo"),L=document.getElementById("download"),D={};function N(a,c){const i=new Blob(c,{type:"video/webm"});L.innerHTML=`
    <a href="#" id="downloadwebm">DOWNLOAD .WEBM</a>
    `,A.disabled=!1,I.disabled=!1;const d=document.getElementById("downloadwebm");let e=URL.createObjectURL(i);d.href=e,d.download="pages.webm"}I.addEventListener("click",()=>{let a=[];const c=m.captureStream(30),i=new MediaRecorder(c,D);i.ondataavailable=d=>{a.push(d.data)},i.onstop=d=>{N(i,a)},i.start(),L.innerHTML=`
    RECORDING...
    `,A.disabled=!0,I.disabled=!0,setTimeout(()=>{i.stop()},3e3)});o.fillStyle=B;b=v;let l=.6,y=!1;function U(){y||(y=!0,setTimeout(()=>{l-=.1},1e3),setTimeout(()=>{l-=.1},2e3),setTimeout(()=>{l-=.1},3e3),setTimeout(()=>{l-=.1},4e3),setTimeout(()=>{l-=.1},5e3),setTimeout(()=>{l+=.2},6e3),setTimeout(()=>{l+=.2},7e3),setTimeout(()=>{l=.6,y=!1},8e3))}function O(){requestAnimationFrame(O),C(),U(),o.globalAlpha=l,o.drawImage(r,h,f,r.width/1.74,r.height/1.74),o.globalAlpha=.5,o.fillRect(h,f-10,r.width/1.74,r.height/1.5),o.globalAlpha=1,o.drawImage(b,0,0,m.width,m.height)}O();
