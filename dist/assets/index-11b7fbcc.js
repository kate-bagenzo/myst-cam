(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const b of t.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&l(b)}).observe(document,{childList:!0,subtree:!0});function i(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function l(e){if(e.ep)return;e.ep=!0;const t=i(e);fetch(e.href,t)}})();const L="/myst-cam/red.png",O="/myst-cam/blue.png",m=512,g=m/(4/3);let r=null,a=null,s=null,u=null,f="red",h="red";r=document.getElementById("webcam");a=document.querySelector("canvas");s=document.getElementById("redstatic");u=document.getElementById("bluestatic");r.setAttribute("width",m);r.setAttribute("height",g);const o=a.getContext("2d");a.width=m*2;a.height=g*2;s.setAttribute("width",m);s.setAttribute("height",g);u.setAttribute("width",m);u.setAttribute("height",g);navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then(d=>{r.srcObject=d,r.play}).catch(d=>{console.error("Could not grab webcam")});s.play();s.play();const y=new Image(500,500);y.src=L;const v="#cd616a",A=new Image(500,500);A.src=O;const T="#6161cd";function S(){h=="red"?o.drawImage(s,592,200,s.width/1.74,s.height/1.74):o.drawImage(u,592,200,u.width/1.74,u.height/1.74)}function R(){h=="red"?(h="blue",o.fillStyle=T,f=A):(h="red",o.fillStyle=v,f=y)}const I=document.getElementById("swapcolors");I.addEventListener("click",()=>{R()});const w=document.getElementById("recordvideo"),B=document.getElementById("download"),C={};function M(d,c){const i=new Blob(c,{type:"video/webm"});B.innerHTML=`
    <a href="#" id="downloadwebm">DOWNLOAD .WEBM</a>
    `,I.disabled=!1,w.disabled=!1;const l=document.getElementById("downloadwebm");let e=URL.createObjectURL(i);l.href=e,l.download="pages.webm"}w.addEventListener("click",()=>{let d=[];const c=a.captureStream(30),i=new MediaRecorder(c,C);i.ondataavailable=l=>{d.push(l.data)},i.onstop=l=>{M(i,d)},i.start(),B.innerHTML=`
    RECORDING...
    `,I.disabled=!0,w.disabled=!0,setTimeout(()=>{i.stop()},3e3)});o.fillStyle=v;f=y;let n=.6,p=!1;function D(){p||(p=!0,setTimeout(()=>{n-=.1},1e3),setTimeout(()=>{n-=.1},2e3),setTimeout(()=>{n-=.1},3e3),setTimeout(()=>{n-=.1},4e3),setTimeout(()=>{n-=.1},5e3),setTimeout(()=>{n+=.2},6e3),setTimeout(()=>{n+=.2},7e3),setTimeout(()=>{n=.6,p=!1},8e3))}function E(){requestAnimationFrame(E),S(),D(),o.globalAlpha=n,o.drawImage(r,592,200,r.width/1.74,r.height/1.74),o.globalAlpha=.5,o.fillRect(592,190,r.width/1.74,r.height/1.5),o.globalAlpha=1,o.drawImage(f,0,0,a.width,a.height)}E();
